/* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//*
 *	@author - Vivek
 *	Exposes a set of functions and objects to work with datasets obtained from ckan.
 */ngds.ckandataset=function(e){var t=this;this.dataset=e;(function(e){if(e===null||typeof e=="undefined")throw"Passed in object was null or undefined."})(e);_ckan_dataset={construct:function(){var t;$.each(e.extras,function(e,n){n.key==="spatial"&&(t=n.value)});var n=$.parseJSON(t),r=e.notes,i={tag:"div",children:[{tag:"p",attributes:{"class":"title"},children:[{tag:"a",attributes:{href:"/dataset/"+e.name,text:e.title,target:"_blank","class":"title"}}]},{tag:"p",attributes:{style:"margin-bottom:3px; margin-top:3px;",text:function(){var e=ngds.util.get_n_chars(r,150);return e!==""?e:"No description."}(),"class":"description"}},{tag:"p",attributes:{text:"Dataset has "+e.num_resources+function(e){return e===1?" resource":" resources"}(e.num_resources),"class":"resources"}}]},s={tag:"div",attributes:{"class":"resources"},children:[{tag:"span",attributes:{"class":"resources",text:e.tags.length==1?"Keyword: ":"Keywords: "}}]};i.children.push(s);var o=0;for(var u=0;u<e.tags.length;u++){if(o>5)break;var a=e.tags[u],f=a.display_name;if(f.length>25)continue;s.children.push({tag:"span",attributes:{"class":"description",text:(o>0?", ":"")+f}});o++}o==0&&s.children.push({tag:"span",attributes:{"class":"description",text:"None"}});e.tags.length>o&&s.children.push({tag:"span",attributes:{"class":"description",text:", ..."}});var l=ngds.util.dom_element_constructor(i)[0].innerHTML;return{getGeoJSON:function(){return n},map:{getPopupHTML:function(){return l}},get_feature_type:function(){return n}}}};return _ckan_dataset.construct()};