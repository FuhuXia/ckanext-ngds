/* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey */var ngds=ngds||{};ngds.state=ngds.state||(ngds.state={});Date.prototype.getISOString=function(e){function t(e){return e<10?"0"+e:e}hours=this.getUTCHours();mins=this.getUTCMinutes();secs=this.getUTCSeconds();if(e===-1){hours=0;mins=0;secs=0}else if(e===1){hours=23;mins=59;secs=59}return this.getUTCFullYear()+"-"+t(this.getUTCMonth()+1)+"-"+t(this.getUTCDate())+"T"+t(hours)+":"+t(mins)+":"+t(secs)+"Z"};(function(){$(document).ready(function(){$(".accordion").accordion({autoHeight:!1,clearStyle:!1,header:"> li > h3",heightStyle:"content",active:!1,collapsible:!0,navigation:!0,icons:{header:"expandIcon",activeHeader:"collapseIcon"},beforeActivate:function(e,t){if(t.newHeader[0])var n=t.newHeader,r=n.next(".ui-accordion-content");else var n=t.oldHeader,r=n.next(".ui-accordion-content");var i=n.attr("aria-selected")=="true";n.toggleClass("ui-corner-all",i).toggleClass("accordion-header-active ui-state-active ui-corner-top",!i).attr("aria-selected",(!i).toString());n.children(".ui-icon").toggleClass("expandIcon",i).toggleClass("collapseIcon",!i);r.toggleClass("accordion-content-active",!i);i?r.slideUp():r.slideDown();return!1}});$(".expanded").parents().filter("li").children().filter("h3").click();$("#expander-image").click(function(){var e=$(".accordion").find("> li > h3");if($(this).attr("src")=="/assets/plus_grey.png"){e.each(function(e,t){$(t).hasClass("ui-state-default")&&$(t).click()});$(this).attr("src","/assets/minus_grey.png");$(this).attr("title","Collapse All")}else{e.each(function(e,t){$(t).hasClass("ui-state-active")&&$(t).click()});$(this).attr("src","/assets/plus_grey.png");$(this).attr("title","Expand All")}return!1});previousElement=$(".pagination ul li a").filter(function(e){return $(this).text()==="«"})[0];if($(previousElement).length>0){var e=$(previousElement).html().replace("«",'<img src = "/assets/previous.png" class="previous"/>');$(previousElement).html(e)}nextElement=$(".pagination ul li a").filter(function(e){return $(this).text()==="»"})[0];if($(nextElement).length>0){var e=$(nextElement).html().replace("»",'<img src = "/assets/next.png" class="previous"/>');$(nextElement).html(e)}$("#save_search").click(function(){var e=window.location.href;$("#dialog-form").dialog("open")});$("#dialog-form").dialog({autoOpen:!1,height:185,width:300,modal:!0,buttons:{"Save Search":function(){var e=window.location.href;ngds.state.search_name=$("#search_name").val();$.ajax({url:"/ngds/save_search",type:"POST",data:{url:e,search_name:$("#search_name").val()},success:function(e){$("#dialog-form").dialog("close");var t=$("<li/>",{}),n=$("<a/>",{text:ngds.state.search_name,href:window.location.href});$("#none").remove();t.append(n);$("#search_name").val("");$("ul#saved-list").append(t);$("ul#saved-list").menu("refresh")}})},Cancel:function(){$(this).dialog("close")}}});menu=$("ul#saved-list").menu().hide();$("#saved_searches_list_button").click(function(){menu.show().position({my:"left top",at:"left bottom",of:this});$(document).one("click",function(){menu.hide()});return!1});$("#field-order-by").change(function(){var e=window.location.href.split("?")[1];typeof e=="undefined"&&$("#hide-button").click();var t=e.split("&"),n=[];for(var r=0;r<t.length;r++)t[r].indexOf("sort=")===-1&&n.push(t[r]);n.push("sort="+$("#field-order-by").val());var i=n.join("&");window.location.href=window.location.href.split("?")[0]+"?"+i});$(".facet").change(function(){window.location.href=$(this).val()});$("#filter-pub-date").click(function(){from_date=$("#from-date").val();to_date=$("#to-date").val();console.log("Entered Here...");console.log(from_date);console.log(to_date);if(from_date===""&&to_date==="")return!1;var e=window.location.href.split("?")[1];console.log(e);var t=[];if(typeof e!="undefined"){var n=e.split("&");for(var r=0;r<n.length;r++)n[r].indexOf("publication_date=")===-1&&t.push(n[r])}date_range="[";if(from_date==="")date_range+=" * TO ";else{from_str=(new Date(from_date)).getISOString(-1);date_range+=from_str+" TO "}if(to_date==="")date_range+=" * ]";else{to_str=(new Date(to_date)).getISOString(1);date_range+=to_str+" ]"}t.push("publication_date="+date_range);var i=t.join("&");console.log(i);window.location.href=window.location.href.split("?")[0]+"?"+i});$("#from-date").datepicker({defaultDate:"-1d",changeMonth:!0,changeYear:!0,yearRange:"c-100:c+50",numberOfMonths:1,onClose:function(e){$("#to-date").datepicker("option","minDate",e)}});$("#to-date").datepicker({defaultDate:"+1d",changeMonth:!0,changeYear:!0,yearRange:"c-100:c+50",numberOfMonths:1,onClose:function(e){$("#from-date").datepicker("option","maxDate",e)}});$("#search-review[title]").tooltip()})})();