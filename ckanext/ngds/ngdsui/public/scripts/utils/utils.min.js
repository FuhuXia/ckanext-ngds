/* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey *//* Copyright (c) 2014, Siemens Corporate Technology and Arizona Geological Survey */ngds.util={};ngds.util.dom_element_constructor=function(e){var t=$("<"+e.tag+"/>",e.attributes);if(typeof e["children"]!="undefined")for(var n=0;n<e.children.length;n++){if(typeof e["children"][n]=="undefined")continue;e.children[n].priority===1?t.prepend(ngds.util.dom_element_constructor(e.children[n])):t.append(ngds.util.dom_element_constructor(e.children[n]))}return t};ngds.util.sequence_generator=function(){var e=0,t=97;return{next:function(){return e+=1},current:function(n){if(typeof n!="undefined"&&n==="alph"){var r=String.fromCharCode(t).toUpperCase();t+=1;return r}return e}}};ngds.util.tick=function(){var e=0,t=function(){return++e},n=function(){return e};return{next:t,current:n}};ngds.util.node_matcher=function(e,t){if(e.className.match(t)!==null)return e.className.substring(e.className.indexOf("-")+1,e.length);var n=$(e).parents();for(var r=0;r<n.length;r++)if(n[r].className.match(t)!==null){var i=n[r].className;return i.substring(i.indexOf("-")+1,i.length)}return null};ngds.util.apply_feature_hover_styles=function(e,t){var n=e.feature.geometry.type;if(n==="Point"){var r=$(".lmarker-"+t);if(r.length>0){r.css("width","30px");r.css("height","45px");var i=$(".lmarker-"+t).next();i.css("font-size","14pt");i.css("margin-left","2px")}}else e.setStyle({weight:2,color:"#d54799",fillColor:ngds.util.state.colorify[t]})};ngds.util.apply_feature_default_styles=function(e,t){var n=e.feature.geometry.type;if(n==="Point"){var r=$(".lmarker-"+t);r.attr("src","/images/marker.png");r.css("width","25px");r.css("height","41px");var i=$(".lmarker-"+t).next();i.css("font-size","12.5pt");i.css("margin-left","0px")}else e.setStyle({weight:1,color:ngds.util.state.colorify[t],fillColor:ngds.util.state.colorify[t],dashArray:"",opacity:.7,fillOpacity:.5})};ngds.util.apply_feature_active_styles=function(e,t){var n=e.layer.feature.geometry.type;$(".result-"+t).addClass("selected");n==="Point"?$(".lmarker-"+t).attr("src","/images/marker-red.png"):e.layer.setStyle({weight:3,color:"red",fillColor:"red",fillOpacity:.2,opacity:1,dashArray:""})};ngds.util.reset_result_styles=function(){$(".result").removeClass("selected")};ngds.util.svg_crispify_post_process=function(){$("#map-container g").attr("shape-rendering","crispEdges")};ngds.util.clear_map_state=function(){$(".jspContainer").remove();$(".results").remove();$(".reader").remove();$(".search-results-page-nums").empty();$(".results-text").remove();ngds.Map.visibility_mgr.clearMgrs();ngds.Map.zoom_handler.clear_listeners();ngds.layer_map={};ngds.Map.clear_layer("geojson");ngds.util.state.map_features=[];for(var e in ngds.util.state.prominence)ngds.Map.map.removeLayer(ngds.util.state.prominence[e]);ngds.util.state.prominence={}};ngds.util.get_n_chars=function(e,t){if(typeof e=="undefined"||e==="")return"";if(e.length<=t)return e;var n=e.slice(0,t-4);while(n[n.length-1]==="."||n[n.length-1]===" ")n=n.slice(0,n.length-1);return n+" ..."};ngds.util.deep_joiner=function(e,t,n){var r=[];for(var i=0;i<e.length;i++)r.push(e[i][t]);return r.join(n)||"None"};ngds.util.replace_content=function(e,t){$(e).empty();e.append(t)};ngds.util.parse_raw_json=function(e){var t=e.replace(/&#34;/g,'"').replace(/&#39;/g,'"').replace(/u\"/g,'"').replace(/null/g,'""');x=JSON.parse(t);return x};ngds.util.state={};ngds.util.rotate_color=function(){var e=["#f26a50","#99ca57","#a299c8","#b74692","#fcd53c","#414686","#0090A8","#f6879f","#177abe","#4a3134","#bd0331"];if(typeof ngds.util.state.rotate_color=="undefined"||ngds.util.state===null){ngds.util.state.rotate_color={};ngds.util.state.rotate_color.index=-1}ngds.util.state.rotate_color.index===e.length-1&&(ngds.util.state.rotate_color.index=-1);ngds.util.state.rotate_color.index=ngds.util.state.rotate_color.index+1;return e[ngds.util.state.rotate_color.index]};ngds.util.make_prominent=function(){typeof ngds.util.state["prominence"]=="undefined"&&(ngds.util.state.prominence={});var e=ngds.util.state.prominence;for(var t in ngds.layer_map){if(typeof ngds.util.state.hidden_t!="undefined"&&typeof ngds.util.state.hidden_t[t]!="undefined"){if(typeof e[t]!="undefined"){ngds.Map.map.removeLayer(e[t]);delete e[t]}continue}if(typeof ngds.util.state.hidden_t!="undefined"&&typeof ngds.util.state.hidden_t[0]!="undefined"){for(var t in ngds.util.state.prominence){ngds.Map.map.removeLayer(e[t]);delete e[t]}return}if(typeof e[t]=="undefined"){var n=ngds.layer_map[t],r=n.getBounds(),i=ngds.util.compute_prominence(n);if(i>24e3){var s=new L.LatLng((r._northEast.lat+r._southWest.lat)/2,(r._northEast.lng+r._southWest.lng)/2),o=new L.CircleMarker(s,{weight:3,color:"green",fillColor:"green",fillOpacity:0,opacity:1,dashArray:"5,5"});o.setRadius(20);ngds.Map.map.addLayer(o);e[t]=o}}else{var n=ngds.layer_map[t];if(ngds.util.compute_prominence(n)<24e3){ngds.Map.map.removeLayer(e[t]);delete e[t]}}}};ngds.util.compute_prominence=function(e){var t=ngds.Map.map.getBounds(),n=(t._northEast.lat-t._southWest.lat)*(t._northEast.lng-t._southWest.lng),r=e.getBounds(),i=(r._northEast.lat-r._southWest.lat)*(r._northEast.lng-r._southWest.lng);return n/i};